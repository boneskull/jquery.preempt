!function($){"use strict";var PLUGIN_NAME="preempt",instance_id="plugin."+PLUGIN_NAME,SCRIPT_URL="javascript:",Preempt=function(a){this._name=PLUGIN_NAME,this._element=a,this._prefix=!1};Preempt.prototype=Object.create({}),Preempt.prototype.init=function init(cfg){var el=this._element,preemptor=function preemptor(evt){var exec=function exec(){return eval("(function(event){ "+js+"}).call(el[0], evt);")},retval;if(before.call(el,evt,data.before)===!1)return!1;if(!evt.isImmediatePropagationStopped()){if(retval=exec(),retval===!1&&!forcePropagation)return!1;if(!evt.isImmediatePropagationStopped()||forcePropagation)return forcePropagation&&retval===!1?after.call(el,evt,data.after):retval=after.call(el,evt,data.after),retval}},attr=cfg.attr,event=cfg.event,forcePropagation=!!cfg.forcePropagation,after=cfg.after||$.noop,before=cfg.before||cfg.callback||$.noop,data=cfg.data||{},js=el.attr(attr)||"";0===js.indexOf(SCRIPT_URL)&&(this._prefix=!0,js=js.substring(11)),el.removeAttr(attr).off(event).on(event,preemptor),el.data(cfg.js_id,js)},Preempt.prototype.restore=function(a){var b=this._element,c=a.js_id,d=a.attr,e=a.event,f=b.data(c);b.attr(d,this._prefix?SCRIPT_URL+f:f).off(e),b.removeData(c)},jQuery.fn.preempt=function(a,b){return $(this).each(function(){var c,d,e,f,g,h=$(this),i=h.data(instance_id);if("undefined"===$.type(a))throw new Error('"options" object is required');if(e=a.attr,f=!!a.restore,g=a.event,!e||!g)throw new Error("jquery.preempt: options.attr and opts.event are required");if(d=instance_id+"."+e+"."+g+".js",c=$.extend({},{js_id:d,callback:b},a),!i){if(f)return;i=new Preempt(h),h.data(instance_id,i)}h.data(d)?f&&i.restore(c):i.init(c)})},jQuery.fn.preempt.Preempt=Preempt}(jQuery);