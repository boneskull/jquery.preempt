!function($,window,document,undefined){"use strict";var PLUGIN_NAME="preempt",instance_id="plugin."+PLUGIN_NAME,cfg_container_id=instance_id+".preempted",SCRIPT_URL="javascript:",Preempt=function(a){this._name=PLUGIN_NAME,this.element=a,this._prefix=!1};Preempt.prototype.init=function init(attr,new_evt,callback){var el=this.element,js=el.attr(attr),preempt=this;callback=callback||$.noop,0===js.indexOf(SCRIPT_URL)&&(this._prefix=!0,js=js.substring(11)),el.removeAttr(attr).off(new_evt).on(new_evt,function preemptor(evt){var ret_val;try{ret_val=eval("+function("+js+")()")}catch(e){return window.alert("jquery-preempt: terrible error; expect the unexpected"),preempt.restore(attr,new_evt),!1}return callback.call(this,evt),ret_val}),el.data(PLUGIN_NAME+"."+attr+"."+new_evt+".js",js)},Preempt.prototype.restore=function(a,b){var c=this.element,d=c.data(cfg_container_id),e=c.data(PLUGIN_NAME+"."+a+"."+b+".js");c.attr(a,this._prefix?SCRIPT_URL+e:e).off(b),delete d[a+b]},$.fn.preempt=function(a,b,c){return this.each(function(){var d,e=this.data(instance_id);return e||(e=new Preempt(this),this.data(instance_id,e)),"string"===$.type(a)&&"undefined"===$.type(b)?e[a].apply(e,arguments):(d=this.data(cfg_container_id),"undefined"===$.type(d)&&(d=this.data(cfg_container_id,{})),void(d[a+b]||e.init(a,b,c)))})}}(jQuery,window,document);