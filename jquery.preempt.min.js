!function($){"use strict";var PLUGIN_NAME="preempt",instance_id="plugin."+PLUGIN_NAME,SCRIPT_URL="javascript:",Preempt=function(a){this._name=PLUGIN_NAME,this._element=a,this._prefix=!1};Preempt.prototype.init=function init(cfg){var el=this._element,preemptor=function preemptor(evt){var exec=function exec(){return eval("(function(event){ "+js+"}).call(el[0]);")},retval;if(before.call(el,evt,data.before)===!1)return!1;if(!evt.isImmediatePropagationStopped()){if(retval=exec(),retval===!1&&!forcePropagate)return!1;if(!evt.isImmediatePropagationStopped()||forcePropagate)return forcePropagate&&retval===!1?!1:after.call(el,evt,data.after)}},attr=cfg.attr,event=cfg.event,forcePropagate=!!cfg.forcePropagate,after=cfg.after||$.noop,before=cfg.before||cfg.callback||$.noop,data=cfg.data||{},js=el.attr(attr)||"";0===js.indexOf(SCRIPT_URL)&&(this._prefix=!0,js=js.substring(11)),el.removeAttr(attr).off(event).on(event,preemptor),el.data(cfg.js_id,js)},Preempt.prototype.restore=function(a){var b=this._element,c=a.js_id,d=a.attr,e=a.event,f=b.data(c);b.attr(d,this._prefix?SCRIPT_URL+f:f).off(e),b.removeData(c)},jQuery.fn.preempt=function(a,b){return $(this).each(function(){var c,d,e=$(this),f=e.data(instance_id),g=a.attr,h=!!a.restore,i=a.event;if(b=b||$.noop,!g||!i)throw new Error("jquery.preempt: options.attr and opts.event are required");if(d=instance_id+"."+g+"."+i+".js",c=$.extend({},{js_id:d,callback:b},a),!f){if(h)return;f=new Preempt(e),e.data(instance_id,f)}e.data(d)?h&&f.restore(c):f.init(c)})}}(jQuery);